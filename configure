#!/bin/sh
LC_ALL=C
packageversion=`grep -F "Version: " DESCRIPTION | cut -f2 -d" "`
git_rev="unknown"

if test -e .git && (which git 1> /dev/null 2>&1) && (git describe --first-parent --always | grep -q "[0-9a-z]\+$"); then
    echo "update git_rev"
    git_rev=`git describe --dirty --first-parent --always --exclude "*"`
fi

if (test "$git_rev" != "unknown") || (test ! -r R/version.R) 2>/dev/null; then
    realversion=${packageversion}.${git_rev}
    R --slave -e "cat(file='./R/version.R', sep='', \"#' irace.version\n#'\n#' A character string containing the version of \\\\pkg{irace}.\n#'\n#' @export\nirace.version <- '${realversion}'\n\")"
fi

